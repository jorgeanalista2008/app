import{N as ve,v as me,G as H,E as ge,p as ce,q as de,u as ye,k as b,m as J,l as ne,O as ue,r as be,c as x,o as p,b as I,d as _,a as D,t as q,y as se,g as pe,P as he,n as ee,B as Q,A as ke,F as oe,i as we}from"./app-CI7qIbXC.js";import{T as je}from"./Label-D5N1lBqm.js";import{T as Se}from"./InputError-DdVaifAZ.js";const xe=()=>{const n={withCredentials:!0,headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}};let h=ve.create(n);return h.interceptors.request.use(function(y){return y}),h.interceptors.response.use(y=>y,y=>{var V,k,w,N;return(k=(V=y.response)==null?void 0:V.data)!=null&&k.errors?console.log(y.response.data.errors):(N=(w=y.response)==null?void 0:w.data)!=null&&N.message&&console.log(y.response.data.message),y.response.status===401&&me.visit("/login"),Promise.reject(y)}),typeof window<"u"&&(window.axios=h),h},ie=xe();var te,re;function Ve(){if(re)return te;re=1;var n="Expected a function",h=NaN,y="[object Symbol]",V=/^\s+|\s+$/g,k=/^[-+]0x[0-9a-f]+$/i,w=/^0b[01]+$/i,N=/^0o[0-7]+$/i,W=parseInt,t=typeof H=="object"&&H&&H.Object===Object&&H,r=typeof self=="object"&&self&&self.Object===Object&&self,o=t||r||Function("return this")(),G=Object.prototype,F=G.toString,z=Math.max,Y=Math.min,c=function(){return o.Date.now()};function O(u,f,j){var C,T,P,A,i,K,R=0,X=!1,$=!1,B=!0;if(typeof u!="function")throw new TypeError(n);f=E(f)||0,m(j)&&(X=!!j.leading,$="maxWait"in j,P=$?z(E(j.maxWait)||0,f):P,B="trailing"in j?!!j.trailing:B);function M(v){var L=C,U=T;return C=T=void 0,R=v,A=u.apply(U,L),A}function e(v){return R=v,i=setTimeout(d,f),X?M(v):A}function l(v){var L=v-K,U=v-R,ae=f-L;return $?Y(ae,P-U):ae}function a(v){var L=v-K,U=v-R;return K===void 0||L>=f||L<0||$&&U>=P}function d(){var v=c();if(a(v))return S(v);i=setTimeout(d,l(v))}function S(v){return i=void 0,B&&C?M(v):(C=T=void 0,A)}function le(){i!==void 0&&clearTimeout(i),R=0,C=K=T=i=void 0}function fe(){return i===void 0?A:S(c())}function Z(){var v=c(),L=a(v);if(C=arguments,T=this,K=v,L){if(i===void 0)return e(K);if($)return i=setTimeout(d,f),M(K)}return i===void 0&&(i=setTimeout(d,f)),A}return Z.cancel=le,Z.flush=fe,Z}function m(u){var f=typeof u;return!!u&&(f=="object"||f=="function")}function g(u){return!!u&&typeof u=="object"}function s(u){return typeof u=="symbol"||g(u)&&F.call(u)==y}function E(u){if(typeof u=="number")return u;if(s(u))return h;if(m(u)){var f=typeof u.valueOf=="function"?u.valueOf():u;u=m(f)?f+"":f}if(typeof u!="string")return u===0?u:+u;u=u.replace(V,"");var j=w.test(u);return j||N.test(u)?W(u.slice(2),j?2:8):k.test(u)?h:+u}return te=O,te}var Te=Ve();const Ke=ge(Te);function Ie(n,h,y){if(!n)throw new Error("A target component has to be provided.");if(!h)throw new Error("A callback has to be provided.");const V=k=>{k.target===n.value||k.composedPath().includes(n.value)||k.target===y.value||k.composedPath().includes(y.value)||typeof h=="function"&&h()};ce(()=>{window.addEventListener("click",V)}),de(()=>{window.removeEventListener("click",V)})}const Ee={class:"flex items-center justify-between"},Ae=["for"],Be=["id","readonly","placeholder"],Ce=["id"],Le=["id"],Oe=["id","onClick"],Pe={class:"ml-3 block font-normal truncate"},Re={key:1,class:"bg-blue-600 text-white cursor-default select-none relative py-2"},$e={class:"flex items-center"},Ne={class:"ml-3 block font-normal truncate"},Fe={key:0},ze={key:1},Me={key:2},De={key:3},Ue={__name:"AutoComplete",props:{id:{type:String,default(){return Math.random().toString().replace("0.","1")}},size:String,label:String,error:String,action:Function,addResult:Array,position:String,disabled:Boolean,actionText:String,defaultText:String,placeholder:String,disable:[String,Number],suggestions:[String,Array],selectedValues:[String,Array],modelValue:[String,Number,Array],json:{type:Boolean,default:!0},hideIcon:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},keepFocus:{type:Boolean,default:!1},labelKey:{type:String,default:"name"},searchable:{type:Boolean,default:!0},valueKey:{type:String,default:"id"},placement:{type:String,default:"bottom"},resetSearch:{type:Boolean,default:!1},inputClass:{type:String,default:""}},emits:["change","update:modelValue"],setup(n,{emit:h}){const{t:y}=ye({}),V=b(null),k=b(null),w=h,N=b(!1),W=b(null),t=n,r=b(""),o=b([]),G=b(null),F=b(!1),z=b(!1),Y=b(""),c=b(null),O=b(!1),m=b(null),g=b([]),s=b([]);J(()=>t.modelValue,async e=>{if(!e)M(),await i();else if(t.multiple){let l=s.value.map(a=>t.json?a[t.valueKey]:a);e.toString()!==l.toString()&&await f()}else N.value=!0,await f()}),J(()=>t.suggestions,e=>o.value=e),J(()=>t.addResult,async e=>{e&&e.value&&(o.value.push(e.value),c.value=e.value,m.value=e.value,B(c.value),setTimeout(()=>{r.value=t.json?e.value[t.labelKey]:e.value,w("update:modelValue",e.value)},100))}),J(r,e=>{t.searchable&&(F.value=!0,Array.isArray(t.suggestions)?t.multiple&&Array.isArray(t.suggestions)?o.value=t.suggestions:o.value=e?t.suggestions.filter(l=>T(l,e)):t.suggestions:e&&(O.value=!0,C(e)))});const E=ne(()=>T(m.value)),u=ne(()=>P(m.value));Ie(k,()=>i(),V),de(()=>{t.multiple&&window.removeEventListener("click",j)}),ce(async()=>{t.multiple&&window.addEventListener("click",j),await f()});const f=async()=>{Array.isArray(t.suggestions)&&(o.value=t.suggestions),t.modelValue&&(g.value=[],Array.isArray(t.suggestions)?(t.multiple?(t.selectedValues?(s.value=t.selectedValues,r.value=t.selectedValues.join(", ")):s.value=t.suggestions.filter(e=>e==t.modelValue||e[t.valueKey]==t.modelValue||t.modelValue.filter(l=>l==e[t.valueKey])[0]||t.modelValue.filter(l=>l[t.valueKey]==e[t.valueKey])[0]||e.id==t.modelValue),t.json?t.suggestions.map((e,l)=>{s.value.find(a=>a[t.valueKey]==e[t.valueKey])&&(g.value=[...g.value,l])}):t.suggestions.map((e,l)=>{s.value.includes(e)&&(g.value=[...g.value,l])}),r.value=s.value.map(e=>t.json?e[t.labelKey]:e).join(", ")):t.json?(m.value=t.suggestions.find(e=>e==t.modelValue||e[t.valueKey]==t.modelValue||e.value==t.modelValue||e.id==t.modelValue),c.value=t.suggestions.findIndex(e=>e==t.modelValue||e[t.valueKey]==t.modelValue||e.value==t.modelValue||e.id==t.modelValue),r.value=E.value):m.value=t.modelValue,await ue(),await i(null,!0)):z.value||ie.post(t.suggestions,{id:t.modelValue}).then(e=>{t.multiple?(c.value=0,o.value=e.data,e.data.map(async(l,a)=>await B(a)),i(null,!0)):(c.value=0,o.value=e.data,m.value=e.data[0],r.value=T(m.value))}).finally(async()=>{await i(),O.value=!1}))},j=e=>{if(e.target==W.value||e.composedPath().includes(W.value))return!1;i(e,!0)},C=Ke(e=>{let l=o.value;l!=null&&l.length&&l[0],!z.value&&e&&e!==E.value?(Y.value=e,ie.post(t.suggestions,{search:e}).then(a=>{o.value=a.data,o.value.length==1&&B(0)}).finally(()=>O.value=!1)):O.value=!1,z.value=!1},300),T=(e,l)=>{if(e===null)return null;if(typeof e!="object")return e;let a="";return t.labelKey?a=t.labelKey:e.label!==void 0?a="label":e.name!==void 0&&(a="name"),l?a?e[a].toLowerCase().includes(l.toString().toLowerCase()):e.toLowerCase().includes(l.toLowerCase()):a?e[a]:e},P=e=>{if(e===null)return null;if(typeof e!="object")return e;let l="";return t.valueKey?l=t.valueKey:e.value!==void 0?l="value":e.id!==void 0&&(l="id"),l?e[l]:e},A=()=>{var e,l;if(t.disabled)return!1;F.value=!0,t.multiple?Array.isArray(t.suggestions)&&(o.value=t.suggestions):(r.value=null,G.value.select(),m.value||(c.value=0),(l=document.getElementById("ac-"+t.id))==null||l.scrollTo({top:(((e=document.getElementById("s"+c.value))==null?void 0:e.offsetTop)||80)-80}))},i=async(e,l,a=!1)=>{if(a)return setTimeout(i,200),!1;!t.multiple||l?(m.value&&(r.value=E.value),await ue(),setTimeout(()=>F.value=!1,10)):s.value&&s.value.length&&(r.value=s.value.map(d=>t.json?d[t.labelKey]:d).join(", "),r.value=r.value||E.value)},K=async e=>(e.preventDefault(),e.stopImmediatePropagation(),B(c.value),await i(),e.stopPropagation(),!1),R=e=>{var l,a;return e.preventDefault(),e.stopPropagation(),c.value>0&&c.value--,t.multiple||(a=document.getElementById("ac-"+t.id))==null||a.scrollTo({top:(((l=document.getElementById("s"+c.value))==null?void 0:l.offsetTop)||80)-80}),!1},X=e=>{var l,a;return e.preventDefault(),e.stopPropagation(),c.value<o.value.length-1&&c.value++,t.multiple||(a=document.getElementById("ac-"+t.id))==null||a.scrollTo({top:(((l=document.getElementById("s"+c.value))==null?void 0:l.offsetTop)||80)-80}),!1},$=e=>t.multiple?g.value.includes(e):e==c.value,B=async(e,l=!1)=>{z.value=!0,e!==void 0&&(t.multiple?(t.json&&s.value.find(a=>a[t.valueKey]==o.value[e][t.valueKey])?s.value=s.value.filter(a=>a[t.valueKey]!=o.value[e][t.valueKey]):s.value.find(a=>a==o.value[e][t.valueKey])?s.value=s.value.filter(a=>a!=o.value[e][t.valueKey]):s.value=[...s.value,o.value[e]],g.value=[],t.multiple?o.value.map((a,d)=>{t.json&&s.value.find(S=>S[t.valueKey]==a[t.valueKey])?g.value=[...g.value,d]:s.value.includes(a)&&(g.value=[...g.value,d])}):t.suggestions.map((a,d)=>{t.json&&s.value.find(S=>S[t.valueKey]==a[t.valueKey])?g.value=[...g.value,d]:s.value.includes(a)&&(g.value=[...g.value,d])}),w("update:modelValue",t.json?s.value.map(a=>a[t.valueKey]):s.value),w("change",s.value),r.value=s.value.map(a=>t.json?a[t.labelKey]:a).join(", "),r.value=r.value||E.value):(c.value=e,m.value=o.value[e],w("update:modelValue",t.json?u.value:m.value),w("change",m.value),r.value=t.resetSearch?null:E.value,await i())),l&&(o.value=[]),t.resetSearch&&(m.value=null,r.value=""),t.keepFocus&&G.value.focus()},M=async()=>{r.value="",c.value=0,m.value=null,g.value=[],s.value=[],w("change",null),w("update:modelValue",""),await i()};return(e,l)=>{const a=be("Icon");return p(),x("div",{ref_key:"excludeRef",ref:V,class:"col-span-6 sm:col-span-4 relative mb-2"},[I("div",Ee,[n.label?(p(),_(je,{key:0,for:n.id,value:n.label,class:"inline-block"},null,8,["for","value"])):D("",!0),n.actionText&&n.action?(p(),x("button",{key:1,type:"button",onClick:l[0]||(l[0]=d=>n.action()),class:"link text-sm focus:ring-0"},q(n.actionText),1)):D("",!0)]),I("div",{class:"relative flex items-center",ref_key:"auto_complete",ref:W},[I("label",{for:n.id,class:"inline-block cursor-pointer absolute top-2 right-0 border border-transparent p-2 text-gray-500"},[n.hideIcon?D("",!0):(p(),_(a,{key:0,name:"c-down",size:"size-4"}))],8,Ae),n.clearable&&n.modelValue?(p(),x("button",{key:0,type:"button",tabindex:"-1",onClick:l[1]||(l[1]=d=>M()),class:"cursor-pointer focus:outline-hidden absolute top-2 right-6 border border-transparent p-2 text-gray-500 hover:text-red-500"},[pe(a,{name:"x",size:"size-4"})])):D("",!0),se(I("input",{id:n.id,ref_key:"input",ref:G,onFocus:A,onClick:A,onKeydown:[Q(R,["up"]),Q(X,["down"]),Q(K,["left"]),Q(K,["right"])],"onUpdate:modelValue":l[2]||(l[2]=d=>r.value=d),autocomplete:"none",readonly:!n.searchable||n.disabled,placeholder:n.placeholder||n.label,class:ee([[n.clearable?"pr-16":"pr-8",n.inputClass||"mt-1 border focus rounded-md shadow-xs",n.size=="small"?"py-1.5 pl-2 text-sm":"py-2 pl-4 text-base",n.error?"border-red-500":"border-gray-300 ",n.disabled?"opacity-60 focus:border-gray-200 focus:ring-0":"focus:border-blue-500 focus:ring-blue-500 "],"block w-full"])},null,42,Be),[[he,r.value]]),se(I("div",{ref_key:"componentRef",ref:k,class:ee(["absolute w-full rounded-md z-20",n.placement=="top"?"mb-1 bottom-full "+n.position:"mt-1 top-full "+n.position])},[I("ul",{id:"ac-"+n.id,class:"max-h-56 rounded-md bg-white border text-base overflow-auto focus:outline-hidden border-blue-300 ring-2 ring-blue-200/50 sm:text-sm"},[o.value&&o.value.length?(p(!0),x(oe,{key:0},we(o.value,(d,S)=>(p(),x(oe,{key:S},[n.disable&&n.disable==P()?D("",!0):(p(),x("li",{key:0,id:"s"+S},[I("button",{type:"button",id:n.id+"-"+S,onClick:le=>B(S),class:ee([$(S)?"bg-blue-500 text-white ":"text-focus","w-full text-left flex items-center select-none relative py-2 hover:bg-blue-200 hover:text-blue-800 focus:outline-hidden focus:ring-0 focus:rounded-none"])},[I("span",Pe,q(d.label||T(d)),1)],10,Oe)],8,Le))],64))),128)):(p(),x("li",Re,[I("div",$e,[I("span",Ne,[O.value?(p(),x("span",Fe,q(e.$t("Searching for results"))+"...",1)):o.value==null?(p(),x("span",ze,q(e.$t("Scan barcode or search items for next")),1)):n.json?(p(),x("span",Me,q(n.defaultText||e.$t("Please type to search")),1)):(p(),x("span",De,q(e.$t("No suggestions to list.")),1))])])]))],8,Ce)],2),[[ke,F.value]])],512),n.error?(p(),_(Se,{key:0,message:n.error.replace(" id",""),class:"mt-0"},null,8,["message"])):D("",!0)],512)}}};export{Ue as _};
